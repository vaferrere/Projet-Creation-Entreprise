!function(e){function t(t,n){e.event.trigger({type:"buildingSelector.dateselector",message:"start dateSelector constructor",time:new Date}),this.el=t,this.$el=e(t),this.instanceId=Math.round((new Date).getTime()+100*Math.random()),this.settings=e.extend({},e.fn[s].defaults,n),this.settings.minMonth=0,this.settings.maxMonth=11,this.settings.minDay=1,this.settings.maxDay=31,this.settings.minHours=0,this.settings.maxHours=23,this.settings.minMinutes=0,this.settings.maxMinutes=59,this.settings.minSeconds=0,this.settings.maxSeconds=59,this.settings.hoursStep&&24%this.settings.hoursStep==0||(this.settings.hoursStep=e.fn[s].defaults.hoursStep),this.settings.minutesStep&&60%this.settings.minutesStep==0||(this.settings.minutesStep=e.fn[s].defaults.minutesStep),this.settings.secondsStep&&60%this.settings.secondsStep==0||(this.settings.secondsStep=e.fn[s].defaults.secondsStep),this.settings.defaultValue instanceof Date||(this.settings.defaultValue=new Date),this.currentValue=this.settings.defaultValue,this.selectElements={},this.init(),e.event.trigger({type:"selectorBuilt.dateselector",message:"end dateSelector constructor",time:new Date})}var s="dateSelector";t.prototype={init:function(){e.event.trigger({type:"initializingSelector.dateselector",message:"start dateSelector initialization",time:new Date}),this.settings.lang&&moment.locale(this.settings.lang);var t=moment.months();if(this.settings.hideSourceNode&&this.$el.css("display","none"),void 0!==this.settings.container){var s=e(this.settings.container);s&&s.length>0&&(this.container=e(s[0]))}switch(void 0===this.container&&(this.container=e("<div>"),this.$el.after(this.container)),this.container.addClass("dateselector-container"),this.container.addClass(this.settings.cssFramework?"dateselector-"+this.settings.cssFramework:"dateselector-default"),this.settings.containerClass&&""!=this.settings.containerClass&&this.container.addClass(this.settings.containerClass),this.settings.cssFramework){case"bootstrap":this.selectElements.yearSelect=e('<ul class="dropdown-menu">'),this.selectElements.monthSelect=e('<ul class="dropdown-menu">'),this.selectElements.daySelect=e('<ul class="dropdown-menu">'),this.selectElements.hoursSelect=e('<ul class="dropdown-menu">'),this.selectElements.minutesSelect=e('<ul class="dropdown-menu">'),this.selectElements.secondsSelect=e('<ul class="dropdown-menu">');break;case"foundation":this.selectElements.yearSelect=e('<ul id="dateselector-year-'+this.instanceId+'" class="f-dropdown">'),this.selectElements.monthSelect=e('<ul id="dateselector-month-'+this.instanceId+'" class="f-dropdown">'),this.selectElements.daySelect=e('<ul id="dateselector-day-'+this.instanceId+'" class="f-dropdown">'),this.selectElements.hoursSelect=e('<ul id="dateselector-hours-'+this.instanceId+'" class="f-dropdown">'),this.selectElements.minutesSelect=e('<ul id="dateselector-minutes-'+this.instanceId+'" class="f-dropdown">'),this.selectElements.secondsSelect=e('<ul id="dateselector-seconds-'+this.instanceId+'" class="f-dropdown">');break;default:this.selectElements.yearSelect=e('<select class="dateselector-year">'),this.selectElements.monthSelect=e('<select class="dateselector-month">'),this.selectElements.daySelect=e('<select class="dateselector-day">'),this.selectElements.hoursSelect=e('<select class="dateselector-hours">'),this.selectElements.minutesSelect=e('<select class="dateselector-minutes">'),this.selectElements.secondsSelect=e('<select class="dateselector-seconds">')}switch(this.settings.cssFramework){case"bootstrap":case"foundation":for(var n=this.settings.maxYear;n>=this.settings.minYear;n--){var l=e('<li value="'+n+'"><a href="#">'+n+"</a></li>");this.selectElements.yearSelect.append(l)}for(var i=this.settings.minMonth;i<=this.settings.maxMonth;i++){var a=e('<li value="'+i+'"><a href="#">'+t[i]+"</a></li>");this.selectElements.monthSelect.append(a)}for(var c=this.settings.minDay;c<=this.settings.maxDay;c++){var o=e('<li value="'+c+'"><a href="#">'+c+"</a></li>");this.selectElements.daySelect.append(o)}for(var d=0;d<24/this.settings.hoursStep;d++){var r=d*this.settings.hoursStep;if(d>=this.settings.minHours&&d<=this.settings.maxHours){var h=e('<li value="'+r+'"><a href="#">'+r+"</a></li>");this.selectElements.hoursSelect.append(h)}}for(var m=0;m<60/this.settings.minutesStep;m++){var u=m*this.settings.minutesStep;if(m>=this.settings.minMinutes&&m<=this.settings.maxMinutes){var p=e('<li value="'+u+'"><a href="#">'+u+"</a></li>");this.selectElements.minutesSelect.append(p)}}for(var g=0;g<60/this.settings.secondsStep;g++){var S=g*this.settings.secondsStep;if(g>=this.settings.minSeconds&&g<=this.settings.maxSeconds){var f=e('<li value="'+S+'"><a href="#">'+S+"</a></li>");this.selectElements.secondsSelect.append(f)}}break;default:for(var n=this.settings.maxYear;n>=this.settings.minYear;n--){var l=e('<option value="'+n+'">'+n+"</option>");this.selectElements.yearSelect.append(l)}for(var i=this.settings.minMonth;i<=this.settings.maxMonth;i++){var a=e('<option value="'+i+'">'+t[i]+"</option>");this.selectElements.monthSelect.append(a)}for(var c=this.settings.minDay;c<=this.settings.maxDay;c++){var o=e('<option value="'+c+'">'+c+"</option>");this.selectElements.daySelect.append(o)}for(var d=0;d<24/this.settings.hoursStep;d++){var r=d*this.settings.hoursStep;if(d>=this.settings.minHours&&d<=this.settings.maxHours){var h=e('<option value="'+r+'">'+r+"</option>");this.selectElements.hoursSelect.append(h)}}for(var m=0;m<60/this.settings.minutesStep;m++){var u=m*this.settings.minutesStep;if(m>=this.settings.minMinutes&&m<=this.settings.maxMinutes){var p=e('<option value="'+u+'">'+u+"</option>");this.selectElements.minutesSelect.append(p)}}for(var g=0;g<60/this.settings.secondsStep;g++){var S=g*this.settings.secondsStep;if(g>=this.settings.minSeconds&&g<=this.settings.maxSeconds){var f=e('<option value="'+S+'">'+S+"</option>");this.selectElements.secondsSelect.append(f)}}}switch(this.settings.cssFramework){case"bootstrap":var v=e('<div class="dropdown"><button class="btn btn-default dropdown-toggle" data-toggle="dropdown">Dropdown<span class="caret"></span></button></div>');this.selectElements.yearSelect=v.clone().addClass("dateselector-year").append(this.selectElements.yearSelect),this.selectElements.monthSelect=v.clone().addClass("dateselector-month").append(this.selectElements.monthSelect),this.selectElements.daySelect=v.clone().addClass("dateselector-day").append(this.selectElements.daySelect),this.selectElements.hoursSelect=v.clone().addClass("dateselector-hours").append(this.selectElements.hoursSelect),this.selectElements.minutesSelect=v.clone().addClass("dateselector-minutes").append(this.selectElements.minutesSelect),this.selectElements.secondsSelect=v.clone().addClass("dateselector-seconds").append(this.selectElements.secondsSelect),v.remove();break;case"foundation":var v=e('<div><button class="button dropdown">Dropdown</button></div>');this.selectElements.yearSelect=v.clone().addClass("dateselector-year").append(this.selectElements.yearSelect),this.selectElements.yearSelect.find(".button.dropdown").attr("data-dropdown","dateselector-year-"+this.instanceId),this.selectElements.monthSelect=v.clone().addClass("dateselector-month").append(this.selectElements.monthSelect),this.selectElements.monthSelect.find(".button.dropdown").attr("data-dropdown","dateselector-month-"+this.instanceId),this.selectElements.daySelect=v.clone().addClass("dateselector-day").append(this.selectElements.daySelect),this.selectElements.daySelect.find(".button.dropdown").attr("data-dropdown","dateselector-day-"+this.instanceId),this.selectElements.hoursSelect=v.clone().addClass("dateselector-hours").append(this.selectElements.hoursSelect),this.selectElements.hoursSelect.find(".button.dropdown").attr("data-dropdown","dateselector-hours-"+this.instanceId),this.selectElements.minutesSelect=v.clone().addClass("dateselector-minutes").append(this.selectElements.minutesSelect),this.selectElements.minutesSelect.find(".button.dropdown").attr("data-dropdown","dateselector-minutes-"+this.instanceId),this.selectElements.secondsSelect=v.clone().addClass("dateselector-seconds").append(this.selectElements.secondsSelect),this.selectElements.secondsSelect.find(".button.dropdown").attr("data-dropdown","dateselector-seconds-"+this.instanceId),v.remove()}switch(this.settings.selectsClass&&""!=this.settings.selectsClass&&(this.selectElements.yearSelect.addClass(this.settings.selectsClass),this.selectElements.monthSelect.addClass(this.settings.selectsClass),this.selectElements.daySelect.addClass(this.settings.selectsClass),this.selectElements.hoursSelect.addClass(this.settings.selectsClass),this.selectElements.minutesSelect.addClass(this.settings.selectsClass),this.selectElements.secondsSelect.addClass(this.settings.selectsClass)),this.settings.defaultValue instanceof Date&&(this._setDateSelectorValue(this.currentValue),this._disableNonAvailableDays()),this.settings.cssFramework){case"bootstrap":case"foundation":var E=this;this.selectElements.yearSelect.find("li a").on("click",function(t){t.preventDefault(),$this=e(t.target),$this.hasClass("disabled")||($this.parent().addClass("selected").siblings().removeClass("selected"),E._updateDateSelector()),"foundation"===E.settings.cssFramework&&Foundation.libs.dropdown.close(E.selectElements.yearSelect.find(".f-dropdown"))}),this.selectElements.monthSelect.find("li a").on("click",function(t){t.preventDefault(),$this=e(t.target),$this.hasClass("disabled")||($this.parent().addClass("selected").siblings().removeClass("selected"),E._updateDateSelector()),"foundation"===E.settings.cssFramework&&Foundation.libs.dropdown.close(E.selectElements.monthSelect.find(".f-dropdown"))}),this.selectElements.daySelect.find("li a").on("click",function(t){t.preventDefault(),$this=e(t.target),$this.hasClass("disabled")||($this.parent().addClass("selected").siblings().removeClass("selected"),E._updateDateSelector()),"foundation"===E.settings.cssFramework&&Foundation.libs.dropdown.close(E.selectElements.daySelect.find(".f-dropdown"))}),this.selectElements.hoursSelect.find("li a").on("click",function(t){t.preventDefault(),$this=e(t.target),$this.hasClass("disabled")||($this.parent().addClass("selected").siblings().removeClass("selected"),E._updateDateSelector()),"foundation"===E.settings.cssFramework&&Foundation.libs.dropdown.close(E.selectElements.hoursSelect.find(".f-dropdown"))}),this.selectElements.minutesSelect.find("li a").on("click",function(t){t.preventDefault(),$this=e(t.target),$this.hasClass("disabled")||($this.parent().addClass("selected").siblings().removeClass("selected"),E._updateDateSelector()),"foundation"===E.settings.cssFramework&&Foundation.libs.dropdown.close(E.selectElements.minutesSelect.find(".f-dropdown"))}),this.selectElements.secondsSelect.find("li a").on("click",function(t){t.preventDefault(),$this=e(t.target),$this.hasClass("disabled")||($this.parent().addClass("selected").siblings().removeClass("selected"),E._updateDateSelector()),"foundation"===E.settings.cssFramework&&Foundation.libs.dropdown.close(E.selectElements.secondsSelect.find(".f-dropdown"))});break;default:var E=this;this.selectElements.yearSelect.on("change",function(){E._updateDateSelector()}),this.selectElements.monthSelect.on("change",function(){E._updateDateSelector()}),this.selectElements.daySelect.on("change",function(){E._updateDateSelector()}),this.selectElements.hoursSelect.on("change",function(){E._updateDateSelector()}),this.selectElements.minutesSelect.on("change",function(){E._updateDateSelector()}),this.selectElements.secondsSelect.on("change",function(){E._updateDateSelector()})}this.settings.showDate&&this.container.append(this.selectElements.daySelect).append(this.selectElements.monthSelect).append(this.selectElements.yearSelect),this.settings.showTime&&this.container.append(this.selectElements.hoursSelect).append(this.selectElements.minutesSelect).append(this.selectElements.secondsSelect),"bootstrap"===this.settings.cssFramework&&this.container.find(".dropdown-toggle").dropdown(),"foundation"===this.settings.cssFramework&&this.container.foundation("dropdown","reflow"),e.event.trigger({type:"selectorInitialized.dateselector",message:"end dateSelector initialization",time:new Date})},destroy:function(){this.$el.removeData()},getDate:function(){return this.currentValue},setDate:function(e){this._setDateSelectorValue(e)},getDateString:function(){return moment(this.currentValue).format(this.settings.dateFormat)},setDateString:function(e){moment(e).isValid()&&this._setDateSelectorValue(moment(e))},getDateStringWithFormat:function(e){return moment(this.currentValue).format(e)},setDateStringWithFormat:function(e,t){moment(e,t,!0).isValid()&&this._setDateSelectorValue(moment(e,t,!0))},_updateSourceInputValue:function(){this.currentValue&&this.$el.val(this.getDateString(this.currentValue))},_disableNonAvailableDays:function(){if(this.currentValue){var e=n(this.currentValue.getFullYear(),this.currentValue.getMonth());switch(this.settings.cssFramework){case"bootstrap":case"foundation":for(var t=1;e>=t;t++)this.selectElements.daySelect.find('li[value="'+t+'"]').removeClass("disabled");for(var s=e+1;s<=this.settings.maxDay;s++)this.selectElements.daySelect.find('li[value="'+s+'"]').addClass("disabled");break;default:for(var t=1;e>=t;t++)this.selectElements.daySelect.find('option[value="'+t+'"]').prop("disabled",!1);for(var s=e+1;s<=this.settings.maxDay;s++)this.selectElements.daySelect.find('option[value="'+s+'"]').prop("disabled",!0)}}},_getDateSelectorValue:function(){e.event.trigger({type:"gettingDate.dateselector",message:"start getDateSelectorValue method",time:new Date});var t;switch(this.settings.cssFramework){case"bootstrap":case"foundation":t=".selected";break;default:t=":selected"}var s=this.selectElements.yearSelect?this.selectElements.yearSelect.find(t).val():void 0,l=this.selectElements.monthSelect?this.selectElements.monthSelect.find(t).val():void 0,i=this.selectElements.daySelect?this.selectElements.daySelect.find(t).val():void 0,a=this.selectElements.hoursSelect?this.selectElements.hoursSelect.find(t).val():void 0,c=this.selectElements.minutesSelect?this.selectElements.minutesSelect.find(t).val():void 0,o=this.selectElements.secondsSelect?this.selectElements.secondsSelect.find(t).val():void 0,d=n(s,l);return i>d&&(this.selectElements.daySelect.find('option[value="'+d+'"]').prop("selected",!0),i=d),e.event.trigger({type:"dateGot.dateselector",message:"end getDateSelectorValue method",time:new Date}),new Date(s?s:this.settings.defaultValue.getFullYear(),l?l:0,i?i:1,a?a:0,c?c:0,o?o:0,0)},_setDateSelectorValue:function(t){switch(e.event.trigger({type:"settingDate.dateselector",message:"start setDateSelectorValue method",time:new Date}),this.settings.cssFramework){case"bootstrap":case"foundation":this.selectElements.yearSelect.find('li[value="'+t.getFullYear()+'"]').addClass("selected").siblings().removeClass("selected"),this.selectElements.monthSelect.find('li[value="'+t.getMonth()+'"]').addClass("selected").siblings().removeClass("selected"),this.selectElements.daySelect.find('li[value="'+t.getDate()+'"]').addClass("selected").siblings().removeClass("selected"),this.selectElements.hoursSelect.find('li[value="'+t.getHours()+'"]').addClass("selected").siblings().removeClass("selected"),this.selectElements.minutesSelect.find('li[value="'+t.getMinutes()+'"]').addClass("selected").siblings().removeClass("selected"),this.selectElements.secondsSelect.find('li[value="'+t.getSeconds()+'"]').addClass("selected").siblings().removeClass("selected");var s="bootstrap"===this.settings.cssFramework?".dropdown-toggle":".dropdown.button",n="bootstrap"===this.settings.cssFramework?'<span class="caret"></span>':"";this.selectElements.yearSelect.find(s).text(this.selectElements.yearSelect.find("li.selected a").text()).append(e(n)),this.selectElements.monthSelect.find(s).text(this.selectElements.monthSelect.find("li.selected a").text()).append(e(n)),this.selectElements.daySelect.find(s).text(this.selectElements.daySelect.find("li.selected a").text()).append(e(n)),this.selectElements.hoursSelect.find(s).text(this.selectElements.hoursSelect.find("li.selected a").text()).append(e(n)),this.selectElements.minutesSelect.find(s).text(this.selectElements.minutesSelect.find("li.selected a").text()).append(e(n)),this.selectElements.secondsSelect.find(s).text(this.selectElements.secondsSelect.find("li.selected a").text()).append(e(n));break;default:this.selectElements.yearSelect.find('option[value="'+t.getFullYear()+'"]').prop("selected",!0),this.selectElements.monthSelect.find('option[value="'+t.getMonth()+'"]').prop("selected",!0),this.selectElements.daySelect.find('option[value="'+t.getDate()+'"]').prop("selected",!0),this.selectElements.hoursSelect.find('option[value="'+t.getHours()+'"]').prop("selected",!0),this.selectElements.minutesSelect.find('option[value="'+t.getMinutes()+'"]').prop("selected",!0),this.selectElements.secondsSelect.find('option[value="'+t.getSeconds()+'"]').prop("selected",!0)}e.event.trigger({type:"dateSet.dateselector",message:"end setDateSelectorValue method",time:new Date})},_updateDateSelector:function(){e.event.trigger({type:"updatingSelector.dateselector",message:"start updateDateSelector method",time:new Date}),this.currentValue=this._getDateSelectorValue(),this._setDateSelectorValue(this.currentValue),this._disableNonAvailableDays(),this._updateSourceInputValue(),this.settings.onDateChange.call(this),e.event.trigger({type:"selectorUpdated.dateselector",message:"end updateDateSelector method",time:new Date})}};var n=function(e,t){return void 0!==e&&void 0!==t?new Date(e,+t+1,0).getDate():void 0};e.fn[s]=function(n){var l=arguments;if(void 0===n||"object"==typeof n)return this.each(function(){e.data(this,"plugin_"+s)||e.data(this,"plugin_"+s,new t(this,n))});if("string"==typeof n&&"_"!==n[0]&&"init"!==n){if(0===Array.prototype.slice.call(l,1).length&&-1!==e.inArray(n,e.fn[s].getters)){var i=e.data(this[0],"plugin_"+s);return i[n].apply(i,Array.prototype.slice.call(l,1))}return this.each(function(){var i=e.data(this,"plugin_"+s);i instanceof t&&"function"==typeof i[n]&&i[n].apply(i,Array.prototype.slice.call(l,1))})}},e.fn[s].getters=["getDate","getDateString"],e.fn[s].defaults={minYear:1970,maxYear:(new Date).getFullYear(),dateFormat:"DD/MM/YYYY HH:mm:ss",showDate:!0,showTime:!1,defaultValue:new Date,hoursStep:1,minutesStep:1,secondsStep:1,cssFramework:void 0,container:void 0,onDateChange:function(){},hideSourceNode:!0,containerClass:void 0,selectsClass:void 0,lang:window.navigator.userLanguage||window.navigator.language}}(jQuery);